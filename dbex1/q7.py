import mysql.connector

if __name__ == '__main__':
    mydb = mysql.connector.connect(
        host="localhost",
        user="root",
        password="root",
        database="covid_db",
        port='3307',
    )
cursor = mydb.cursor()
# I assume the MONTH checks all valid date formats.
# We consider that MONTHLY address to the average/MAX/MIN between months.
# For example, for 1 2 3 4 5 6 7 8 9 10 11 12 the average is 6.5, but if we group the numbers to pairs
# (months in our case) the calculation is (3+7+11+15+19+23) / 6 = 13.

cursor.execute("""
    SELECT
        location,
        AVG(month_sum) AS avg,
        MAX(month_sum) AS max_monthly,
        MIN(month_sum) AS min_monthly
    FROM
        (SELECT location, MONTH(date) AS month, SUM(new_cases) AS month_sum
        FROM covid_deaths
        GROUP BY location, MONTH(date)) AS z
    GROUP BY
        location;
     ;""")

# ('Afghanistan', Decimal('10018.0000'), Decimal('63120'), Decimal('692')), ('Africa', Decimal('472115.9167'), Decimal('922431'), Decimal('229700')), ('Albania', Decimal('11044.5833'), Decimal('29040'), Decimal('1594')), ('Algeria', Decimal('11789.2500'), Decimal('25257'), Decimal('4815')), ('Andorra', Decimal('1159.8333'), Decimal('2706'), Decimal('77')), ('Angola', Decimal('3269.1667'), Decimal('7958'), Decimal('1011')), ('Anguilla', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Antigua and Barbuda', Decimal('105.3333'), Decimal('496'), Decimal('3')), ('Argentina', Decimal('377956.0833'), Decimal('816844'), Decimal('180126')), ('Armenia', Decimal('18796.0833'), Decimal('45311'), Decimal('5032')), ('Aruba', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Asia', Decimal('4628531.7500'), Decimal('12357371'), Decimal('1982733')), ('Australia', Decimal('2567.0000'), Decimal('9521'), Decimal('176')), ('Austria', Decimal('54228.0833'), Decimal('177531'), Decimal('3689')), ('Azerbaijan', Decimal('28034.7500'), Decimal('97524'), Decimal('3794')), ('Bahamas', Decimal('1061.2500'), Decimal('2591'), Decimal('303')), ('Bahrain', Decimal('22202.1667'), Decimal('71955'), Decimal('5311')), ('Bangladesh', Decimal('78743.0833'), Decimal('211048'), Decimal('11077')), ('Barbados', Decimal('340.5000'), Decimal('1523'), Decimal('16')), ('Belarus', Decimal('35112.5000'), Decimal('64230'), Decimal('4035')), ('Belgium', Decimal('90542.3333'), Decimal('310777'), Decimal('8701')), ('Belize', Decimal('1111.9167'), Decimal('4922'), Decimal('116')), ('Benin', Decimal('683.2500'), Decimal('1675'), Decimal('212')), ('Bermuda', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Bhutan', Decimal('179.9167'), Decimal('582'), Decimal('8')), ('Bolivia', Decimal('37080.6667'), Decimal('91582'), Decimal('2951')), ('Bonaire Sint Eustatius and Saba', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Bosnia and Herzegovina', Decimal('17087.2500'), Decimal('39067'), Decimal('2953')), ('Botswana', Decimal('5953.5833'), Decimal('14899'), Decimal('829')), ('Brazil', Decimal('1564150.6667'), Decimal('2898779'), Decimal('724670')), ('British Virgin Islands', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Brunei', Decimal('21.8333'), Decimal('155'), Decimal('2')), ('Bulgaria', Decimal('35169.5000'), Decimal('95994'), Decimal('4567')), ('Burkina Faso', Decimal('1124.5000'), Decimal('3975'), Decimal('159')), ('Burundi', Decimal('457.8333'), Decimal('1194'), Decimal('58')), ('Cambodia', Decimal('4524.2500'), Decimal('20307'), Decimal('3')), ('Cameroon', Decimal('6738.1667'), Decimal('26220'), Decimal('955')), ('Canada', Decimal('118696.5833'), Decimal('285489'), Decimal('12637')), ('Cape Verde', Decimal('2727.9167'), Decimal('6871'), Decimal('1079')), ('Cayman Islands', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Central African Republic', Decimal('595.0833'), Decimal('2784'), Decimal('18')), ('Chad', Decimal('412.5833'), Decimal('1263'), Decimal('70')), ('Chile', Decimal('130815.3333'), Decimal('327399'), Decimal('41487')), ('China', Decimal('7614.6667'), Decimal('69820'), Decimal('354')), ('Colombia', Decimal('362541.2500'), Decimal('902989'), Decimal('155593')), ('Comoros', Decimal('329.8333'), Decimal('1903'), Decimal('45')), ('Congo', Decimal('1057.9167'), Decimal('2212'), Decimal('201')), ('Cook Islands', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Costa Rica', Decimal('30933.8333'), Decimal('68332'), Decimal('11065')), ("Cote d'Ivoire", Decimal('4047.0000'), Decimal('11314'), Decimal('615')), ('Croatia', Decimal('30019.7500'), Decimal('82395'), Decimal('2727')), ('Cuba', Decimal('17020.5833'), Decimal('49023'), Decimal('1290')), ('Curacao', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Cyprus', Decimal('6501.8333'), Decimal('19957'), Decimal('267')), ('Czechia', Decimal('138994.5833'), Decimal('300160'), Decimal('5268')), ('Democratic Republic of Congo', Decimal('3515.0833'), Decimal('13154'), Decimal('562')), ('Denmark', Decimal('24679.0000'), Decimal('83114'), Decimal('2705')), ('Djibouti', Decimal('967.0833'), Decimal('4157'), Decimal('29')), ('Dominica', Decimal('16.1667'), Decimal('35'), Decimal('1')), ('Dominican Republic', Decimal('27411.8333'), Decimal('47718'), Decimal('14219')), ('Ecuador', Decimal('38511.8333'), Decimal('75801'), Decimal('19827')), ('Egypt', Decimal('23506.8333'), Decimal('61958'), Decimal('4259')), ('El Salvador', Decimal('6649.1667'), Decimal('11218'), Decimal('3348')), ('Equatorial Guinea', Decimal('729.9167'), Decimal('2845'), Decimal('58')), ('Eritrea', Decimal('507.3333'), Decimal('2079'), Decimal('40')), ('Estonia', Decimal('10932.3333'), Decimal('41568'), Decimal('199')), ('Eswatini', Decimal('1590.3333'), Decimal('6353'), Decimal('322')), ('Ethiopia', Decimal('23036.2500'), Decimal('50958'), Decimal('9307')), ('Europe', Decimal('4073952.5833'), Decimal('7381951'), Decimal('740687')), ('European Union', Decimal('2762969.2500'), Decimal('5226912'), Decimal('244388')), ('Faeroe Islands', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Falkland Islands', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Fiji', Decimal('513.4167'), Decimal('3980'), Decimal('1')), ('Finland', Decimal('8038.5833'), Decimal('21195'), Decimal('654')), ('France', Decimal('516403.1667'), Decimal('1089350'), Decimal('33901')), ('French Polynesia', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Gabon', Decimal('2089.6667'), Decimal('5002'), Decimal('202')), ('Gambia', Decimal('506.5833'), Decimal('2465'), Decimal('55')), ('Georgia', Decimal('30754.0000'), Decimal('96648'), Decimal('319')), ('Germany', Decimal('311539.1667'), Decimal('690608'), Decimal('17246')), ('Ghana', Decimal('8026.4167'), Decimal('18163'), Decimal('1429')), ('Gibraltar', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Greece', Decimal('35497.0000'), Decimal('82621'), Decimal('4576')), ('Greenland', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Grenada', Decimal('13.4167'), Decimal('86'), Decimal('0')), ('Guatemala', Decimal('25167.6667'), Decimal('52175'), Decimal('14123')), ('Guernsey', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Guinea', Decimal('1983.9167'), Decimal('3938'), Decimal('603')), ('Guinea-Bissau', Decimal('323.4167'), Decimal('1083'), Decimal('11')), ('Guyana', Decimal('1698.1667'), Decimal('3740'), Decimal('491')), ('Haiti', Decimal('1554.8333'), Decimal('8474'), Decimal('218')), ('Honduras', Decimal('22321.5000'), Decimal('38889'), Decimal('11365')), ('Hong Kong', Decimal('995.1667'), Decimal('2532'), Decimal('114')), ('Hungary', Decimal('67349.7500'), Decimal('224326'), Decimal('419')), ('Iceland', Decimal('546.2500'), Decimal('2137'), Decimal('18')), ('India', Decimal('2545452.7500'), Decimal('9165821'), Decimal('354633')), ('Indonesia', Decimal('190340.3333'), Decimal('386481'), Decimal('66420')), ('International', Decimal('60.1667'), Decimal('705'), Decimal('0')), ('Iran', Decimal('271234.8333'), Decimal('663548'), Decimal('71008')), ('Iraq', Decimal('114289.5833'), Decimal('215666'), Decimal('24345')), ('Ireland', Decimal('22858.8333'), Decimal('104768'), Decimal('2746')), ('Isle of Man', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Israel', Decimal('70247.4167'), Decimal('220173'), Decimal('2177')), ('Italy', Decimal('355276.4167'), Decimal('922124'), Decimal('10367')), ('Jamaica', Decimal('4186.8333'), Decimal('16010'), Decimal('294')), ('Japan', Decimal('67264.8333'), Decimal('156391'), Decimal('15195')), ('Jersey', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Jordan', Decimal('62766.0000'), Decimal('220761'), Decimal('841')), ('Kazakhstan', Decimal('40939.7500'), Decimal('81126'), Decimal('8992')), ('Kenya', Decimal('15489.0000'), Decimal('28426'), Decimal('4315')), ('Kiribati', Decimal('0.6667'), Decimal('2'), Decimal('0')), ('Kosovo', Decimal('8983.0833'), Decimal('20836'), Decimal('2166')), ('Kuwait', Decimal('30306.0000'), Decimal('66617'), Decimal('7949')), ('Kyrgyzstan', Decimal('10886.0833'), Decimal('35929'), Decimal('1663')), ('Laos', Decimal('187.0000'), Decimal('1155'), Decimal('1')), ('Latvia', Decimal('11469.2500'), Decimal('25337'), Decimal('165')), ('Lebanon', Decimal('45464.1667'), Decimal('119549'), Decimal('3481')), ('Lesotho', Decimal('964.0000'), Decimal('5570'), Decimal('25')), ('Liberia', Decimal('376.6667'), Decimal('2394'), Decimal('31')), ('Libya', Decimal('16253.5000'), Decimal('26570'), Decimal('4365')), ('Liechtenstein', Decimal('253.5000'), Decimal('866'), Decimal('11')), ('Lithuania', Decimal('23240.6667'), Decimal('80644'), Decimal('376')), ('Luxembourg', Decimal('5919.2500'), Decimal('17544'), Decimal('-70')), ('Macao', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Madagascar', Decimal('3525.9167'), Decimal('12659'), Decimal('230')), ('Malawi', Decimal('3077.1667'), Decimal('17380'), Decimal('98')), ('Malaysia', Decimal('64887.6667'), Decimal('180442'), Decimal('364')), ('Maldives', Decimal('6195.9167'), Decimal('35866'), Decimal('746')), ('Mali', Decimal('1204.0833'), Decimal('4278'), Decimal('241')), ('Malta', Decimal('2554.3333'), Decimal('6720'), Decimal('140')), ('Marshall Islands', Decimal('0.4000'), Decimal('2'), Decimal('0')), ('Mauritania', Decimal('1756.3333'), Decimal('5763'), Decimal('201')), ('Mauritius', Decimal('154.8333'), Decimal('561'), Decimal('12')), ('Mexico', Decimal('211672.3333'), Decimal('438166'), Decimal('123877')), ('Micronesia (country)', Decimal('0.1429'), Decimal('1'), Decimal('0')), ('Moldova', Decimal('21414.1667'), Decimal('45141'), Decimal('8356')), ('Monaco', Decimal('215.5833'), Decimal('614'), Decimal('27')), ('Mongolia', Decimal('10567.5833'), Decimal('57080'), Decimal('9')), ('Montenegro', Decimal('8360.5833'), Decimal('16924'), Decimal('853')), ('Montserrat', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Morocco', Decimal('44545.8333'), Decimal('137252'), Decimal('11351')), ('Mozambique', Decimal('6679.2500'), Decimal('20696'), Decimal('1056')), ('Myanmar', Decimal('13783.7500'), Decimal('39333'), Decimal('519')), ('Namibia', Decimal('7975.2500'), Decimal('34549'), Decimal('1445')), ('Nauru', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Nepal', Decimal('53718.5000'), Decimal('239630'), Decimal('3170')), ('Netherlands', Decimal('143072.5000'), Decimal('276452'), Decimal('8230')), ('New Caledonia', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('New Zealand', Decimal('229.9167'), Decimal('944'), Decimal('50')), ('Nicaragua', Decimal('681.5000'), Decimal('2614'), Decimal('192')), ('Niger', Decimal('458.8333'), Decimal('1775'), Decimal('21')), ('Nigeria', Decimal('13988.2500'), Decimal('43635'), Decimal('4005')), ('North America', Decimal('3316209.2500'), Decimal('7131957'), Decimal('1503381')), ('North Macedonia', Decimal('12975.8333'), Decimal('30306'), Decimal('3587')), ('Northern Cyprus', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Norway', Decimal('10995.7500'), Decimal('29699'), Decimal('994')), ('Oceania', Decimal('4738.0000'), Decimal('11384'), Decimal('506')), ('Oman', Decimal('22930.5000'), Decimal('79954'), Decimal('5168')), ('Pakistan', Decimal('80305.0000'), Decimal('176594'), Decimal('16957')), ('Palestine', Decimal('26214.0833'), Decimal('58860'), Decimal('7797')), ('Panama', Decimal('34010.2500'), Decimal('80984'), Decimal('14876')), ('Papua New Guinea', Decimal('1424.8333'), Decimal('5013'), Decimal('55')), ('Paraguay', Decimal('35728.5833'), Decimal('77027'), Decimal('8578')), ('Peru', Decimal('172092.7500'), Decimal('286549'), Decimal('52607')), ('Philippines', Decimal('119697.4167'), Decimal('296576'), Decimal('42434')), ('Pitcairn', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Poland', Decimal('240022.5000'), Decimal('628080'), Decimal('11653')), ('Portugal', Decimal('74090.6667'), Decimal('306838'), Decimal('6940')), ('Qatar', Decimal('18547.8333'), Decimal('55307'), Decimal('5001')), ('Romania', Decimal('90079.2500'), Decimal('234023'), Decimal('10768')), ('Russia', Decimal('462017.4167'), Decimal('851411'), Decimal('153941')), ('Rwanda', Decimal('3548.7500'), Decimal('12739'), Decimal('297')), ('Saint Helena', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Saint Kitts and Nevis', Decimal('41.0000'), Decimal('378'), Decimal('0')), ('Saint Lucia', Decimal('443.8333'), Decimal('2195'), Decimal('1')), ('Saint Vincent and the Grenadines', Decimal('186.0833'), Decimal('780'), Decimal('4')), ('Samoa', Decimal('0.3333'), Decimal('2'), Decimal('0')), ('San Marino', Decimal('424.2500'), Decimal('1249'), Decimal('1')), ('Sao Tome and Principe', Decimal('198.0000'), Decimal('529'), Decimal('15')), ('Saudi Arabia', Decimal('41065.4167'), Decimal('141232'), Decimal('5333')), ('Senegal', Decimal('3647.3333'), Decimal('7997'), Decimal('473')), ('Serbia', Decimal('59739.4167'), Decimal('162485'), Decimal('2145')), ('Seychelles', Decimal('1321.4167'), Decimal('5748'), Decimal('8')), ('Sierra Leone', Decimal('482.7500'), Decimal('2029'), Decimal('46')), ('Singapore', Decimal('5218.0833'), Decimal('19621'), Decimal('203')), ('Sint Maarten (Dutch part)', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Slovakia', Decimal('32643.0833'), Decimal('73614'), Decimal('700')), ('Slovenia', Decimal('21451.7500'), Decimal('46338'), Decimal('642')), ('Solomon Islands', Decimal('2.0000'), Decimal('9'), Decimal('0')), ('Somalia', Decimal('1248.0833'), Decimal('4146'), Decimal('70')), ('South Africa', Decimal('171908.0000'), Decimal('430898'), Decimal('36117')), ('South America', Decimal('2776635.6667'), Decimal('5421579'), Decimal('1465491')), ('South Korea', Decimal('13399.5000'), Decimal('27117'), Decimal('2746')), ('South Sudan', Decimal('905.5000'), Decimal('3997'), Decimal('177')), ('Spain', Decimal('319489.0000'), Decimal('814854'), Decimal('64159')), ('Sri Lanka', Decimal('22135.8333'), Decimal('79188'), Decimal('234')), ('Sudan', Decimal('3054.8333'), Decimal('7455'), Decimal('158')), ('Suriname', Decimal('1865.0000'), Decimal('7270'), Decimal('109')), ('Sweden', Decimal('90906.6667'), Decimal('194250'), Decimal('7303')), ('Switzerland', Decimal('58611.1667'), Decimal('172821'), Decimal('3848')), ('Syria', Decimal('2137.7500'), Decimal('3857'), Decimal('616')), ('Taiwan', Decimal('1252.4167'), Decimal('7396'), Decimal('21')), ('Tajikistan', Decimal('1133.0833'), Decimal('3915'), Decimal('0')), ('Tanzania', Decimal('42.4167'), Decimal('461'), Decimal('0')), ('Thailand', Decimal('23588.5833'), Decimal('99599'), Decimal('102')), ('Timor', Decimal('789.6667'), Decimal('4718'), Decimal('0')), ('Togo', Decimal('1172.4167'), Decimal('3382'), Decimal('384')), ('Tonga', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Trinidad and Tobago', Decimal('2785.6667'), Decimal('13086'), Decimal('149')), ('Tunisia', Decimal('36969.2500'), Decimal('74726'), Decimal('2268')), ('Turkey', Decimal('384761.9167'), Decimal('1610082'), Decimal('39260')), ('Turkmenistan', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Turks and Caicos Islands', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Tuvalu', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('Uganda', Decimal('6969.6667'), Decimal('33302'), Decimal('554')), ('Ukraine', Decimal('192025.9167'), Decimal('408802'), Decimal('30360')), ('United Arab Emirates', Decimal('53289.6667'), Decimal('95791'), Decimal('9725')), ('United Kingdom', Decimal('410014.0000'), Decimal('1331954'), Decimal('33290')), ('United States', Decimal('2809797.1667'), Decimal('6429546'), Decimal('1208552')), ('Uruguay', Decimal('31059.0833'), Decimal('96255'), Decimal('331')), ('Uzbekistan', Decimal('9383.0833'), Decimal('17884'), Decimal('1215')), ('Vanuatu', Decimal('0.4444'), Decimal('2'), Decimal('0')), ('Vatican', Decimal('2.2500'), Decimal('15'), Decimal('0')), ('Venezuela', Decimal('23136.2500'), Decimal('42869'), Decimal('10381')), ('Vietnam', Decimal('1688.4167'), Decimal('9647'), Decimal('50')), ('Wallis and Futuna', Decimal('0.0000'), Decimal('0'), Decimal('0')), ('World', Decimal('15272243.3333'), Decimal('24906909'), Decimal('7904329')), ('Yemen', Decimal('577.4167'), Decimal('2072'), Decimal('14')), ('Zambia', Decimal('13690.1667'), Decimal('60222'), Decimal('1215')), ('Zimbabwe', Decimal('4539.5000'), Decimal('19521'), Decimal('529'))


print(', '.join(str(row) for row in cursor.fetchall()))
